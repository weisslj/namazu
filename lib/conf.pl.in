# -*- CPerl -*-
# $Id: conf.pl.in,v 1.10 1999-08-27 01:30:52 satoru Exp $
# Copyright (C) 1997-1999 Satoru Takabayashi  All rights reserved.
#     This is free software with ABSOLUTELY NO WARRANTY.
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either versions 2, or (at your option)
#  any later version.
# 
#  This program is distributed in the hope that it will be useful
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
#  02111-1307, USA
#
#  This file must be encoded in EUC-JP encoding
#

package conf;

##
## software information
##
$VERSION = "@VERSION@";
$COPYRIGHT = "Copyright (C) 1997-1999 Satoru Takabayashi  All rights reserved.";
$NMZ_URI = "http://openlab.ring.gr.jp/namazu/";

# Japanese usage
$USAGE_JA = <<EOFusage;
mknmz v$VERSION -  全文検索システム Namazu のインデックス作成プログラム
$COPYRIGHT

使い方: mknmz [options] [URI prefix] <target(s)>

  対象ファイル:
    -a, --all                すべてのファイルを対象とする
    -e, --robots-txt         ロボットよけされているファイルを除外する
    -A, --htaccess           .htaccess で制限されたファイルを除外する
    -F, --target-list=file   インデックス対象のファイルのリストを読み込む
    -t, --allow-regex=regex  対象ファイルの正規表現を指定する

  形態素解析:
    -c, --use-chasen        日本語の単語のわかち書きに ChaSen を用いる
    -k, --use-kakasi        日本語の単語のわかち書きに KAKASI を用いる
    -m, --use-chasen-morph  名詞のみを抽出する

  フィルタ制御:
    -r, --man          man のファイルを処理する
    -u, --uuencode     uuencode と BinHex の部分を無視する
    -h, --rfc822       Mail/News のヘッダ部分をそれなりに処理する
    -M, --no-mhonarc   MHonArc で作成された HTML の処理を行わない

  文字列処理:
    -E, --no-edge-symbol  単語の両端の記号は削除する
    -G, --no-okurigana    送り仮名を削除する
    -H, --no-hiragana     平仮名のみの単語は登録しない
    -K, --no-symbol       記号をすべて削除する
    -L, --no-line-adjust  行頭・行末の調整処理を行わない

  要約:
    -U, --no-encode-uri       URIのencodeを行わない
    -x, --no-heading-summary  HTML のヘディングによる要約作成を行わない


  インデックス作成:
    -P, --no-heading-summary  フレーズ検索用のインデックスを作成しない
    -R, --no-regex-index      正規表現検索用のインデックスを作成しない
    -W, --no-date-index       日付によるソート用のインデックス作成しない
    -X, --no-field-index      フィールド検索用のインデックスを作成しない
    -Y, --no-delete           削除された文書の検出を行わない
    -Z, --no-update           文書の更新/削除を反映しない

  その他:
    -s, --checkpoint        チェックポイント機構を作動させる
    -q, --quiet             インデックス処理の最中にメッセージを表示しない
    -I, --include=file      カスタマイズ用ファイルを読み込む
    -O, --output-dir=dir    インデックスの出力先を指定する
    -T, --template-dir=dir  NMZ.{head,foot,body}.* のディレクトリを指定する
    -l, --lang=lang         言語を設定する ('en' or 'ja')
    -v, --version           ヴァージョンを表示する
    -0, --help              このヘルプを表示する
EOFusage

$USAGE_EN = <<EOFusage;
  mknmz.pl v$VERSION -  indexer of Namazu
  $COPYRIGHT

   Usage: mknmz [options] [URI prefix] <target(s)>
      -a: target all files
      -c: use ChaSen as Japanese processor
      -e: exclude files which has robot exclusion
      -h: treat header part of Mail/News well
      -k: use KAKASI as Japanese processor
      -m: use ChaSen as Japanese processor with morphological processing
      -q: suppress status messages during execution
      -r: treat man files
      -u: decode uuencoded part and discard BinHex part
      -x: do not make summary with structure of HTML's headings
      -s: turn on the checkpoint mechanism (self exec periodically)
      -D: do not insert headers such as 'Date:' to summary (default: off)
      -E: delete symbols on edge of word (default: off)
      -G: delete Okurigana in word (default: off)
      -H: ignore words consist of Hiragana only (default: off)
      -K: delete all symbols (default: off)
      -L: do not adjust beginning and end of line (default: off)
      -M: do not do special processing for MHonArc (default: off)
      -P: do not make the index for phrase search (default: off)
      -R: do not make the index for regex search (default: off)
      -U: do not encode URI (default: off)
      -W: do not make the index for sort by date (default: off)
      -X: do not make the index for field search (default: off)
      -Y: do not detect deleted documents (default: off)
      -Z: do not detect update and deleted documents (default: off)
      -A: exclude files restricted by .htaccess
      -l (lang): specify the language ('en' or 'ja', default:en)
      -I (file): include user defined file in advance of index processing
      -F (file): load a file which contains list of target files
      -O (dir) : specify a directory to output the index
      -T (dir) : specify a directory where NMZ.{head,foot,body}.* are
      -t (regex): specify a regex for target files

EOFusage

##
## required softwares
##

## Network Kanji Filter nkf v1.62
$NKF = "@NKF@"; 

## KAKASI or ChaSen (to handle Japanese characters)
## KAKASI must have -w option added by Hajime BABA-san
$KAKASI = "@KAKASI@ -ieuc -oeuc -w";

## ChaSen 1.51 (simple wakatigaki)
$CHASEN = "@CHASEN@ -j -F '\%m '";

## ChaSen 1.51 (with morphological processing)
$CHASEN_MORPH = "@CHASEN@ -j -F '\%m %H\\n'";

## Default Japanese processer
$WAKATI  = $@OPT_WAKATI_DEFAULT@;

## Table of helper programs and extentions
#%HELPER_PROGRAMS = (
#    'gz'  => '@OPT_HELPER_ZCAT@',
#    'Z'   => '@OPT_HELPER_ZCAT@',
#    'man' => '@OPT_HELPER_MAN@',
#);

## Make regex of extensions
#$HELPER_EXTENSIONS = 
#    join('|', sort {length($b) <=> length($a)} keys %HELPER_PROGRAMS);

##
## Default values
##
$LANGUAGE = "@OPT_LANGUAGE@";  # language of messages
$ADMIN  = '@OPT_ADMIN_EMAIL@'; # admin's email address
$CGI_ACTION = '@OPT_CGI_LOCATION@/namazu.cgi'; # <FORM> 's ACTION の指定

## Prefix of URI
$URI_PREFIX = "";

## Files can be omission in URI. e.g. index.html
## name of the file or files which can be abbreviated.
## (specify by regular expression)
## e.g. index.html|index.htm|Default.html
## it's useful to use Namazu as WWW search engine.
## ("_default" would be made by httpdown)
$DEFAULT_FILE = "_default";

## Target files' regex
## target file for indexing (case insensitive)
## ("_default" is a file httpdown would generate.)
## do *not* use '$' and '^' regular expression meta charactors.
## that will be automatically appended by mknmz.pl.
##
$ALLOW_REGEX = '.*\.html?|.*\.txt|.*_default';

## Non-Target files' regex
## this regular expression describes the names of the files which
## you do *not* want to index (case insensitive). this setting is
## effective when mknmz runs with -a option.
## do *not* use '$' and '^' regular expression meta charactors.
## that will be automatically appended by mknmz.pl.
##
$DENY_REGEX = '.*\.gif|.*\.(jpg|jpeg)|.*\.tar\.gz|core|.*\.bak|.*~|\..*|\x23.*|NMZ\..*';

## HTML extentions like .htm, .html, .shtml, .phtml, .html.en, .html.ja, .asp
$HTML_SUFFIX = 'html?|[ps]html|html\.[a-z]{2}|asp|cgi';

## Place where CGI prgrams is in. e.g. /cgi-bin/, /htbin/
$CGI_DIR = '/(cgi-bin|htbin)/';

## MHonArc's message file
$MHONARC_MESSAGE_FILE = 'msg\d{5}\.html(?:\.gz)?';

## MHonArc's header for identification (regex)
$MHONARC_HEADER = '<\!-- MHonArc v\d\.\d\.\d -->';

## Mail/News's headers should be remained as searchable text
## (case insensitive)
$REMAIN_HEADER = "From|Date|Message-ID";

## Mail/News's headers for field specified search (NMZ.field.*)
$SEARCH_FIELD = "message-id|subject|from|date|uri|newsgroups|to|summary|size";

## Aliases for NMZ.field.*
%FIELD_ALIASES = ('title' => 'subject', 'author' => 'from');


$TEXT_TITLE = " (Text File) "; # text file
$NO_TITLE = "No title in original";    # document has no title


##
## Names of Index files
##
$DBNAME     = "NMZ";
%File = ();
$File{INDEX}      = "$DBNAME.i";
$File{INDEXINDEX} = "$DBNAME.ii";
$File{REGISTRY}    = "$DBNAME.r";
$File{HEADERFILE} = "$DBNAME.head";
$File{FOOTERFILE} = "$DBNAME.foot";
$File{LOGFILE}    = "$DBNAME.log";
$File{SLOGFILE}   = "$DBNAME.slog";
$File{LOCKFILE}   = "$DBNAME.lock";
$File{LOCKFILE2}  = "$DBNAME.lock2";
$File{LOCKMSGFILE} = "$DBNAME.msg";
$File{BODYMSGFILE} = "$DBNAME.body";
$File{ERRORSFILE} = "$DBNAME.err";
$File{WORDLIST}    = "$DBNAME.w";
$File{PHRASE}      = "$DBNAME.p";
$File{PHRASEINDEX} = "$DBNAME.pi";
$File{FIELDINFO}   = "$DBNAME.field";
$File{FLIST}       = "$DBNAME.flist";
$File{RESULTFILE} = "$DBNAME.result";

$File{BIGENDIAN}  = "$DBNAME.be";
$File{LITTLEENDIAN}  = "$DBNAME.le";

$File{DATEINDEX} = "$DBNAME.t";

$File{TOTALFILESCOUNT} = "$DBNAME.total";
$File{TOTALKEYSCOUNT}  = "$DBNAME.keys";

$File{BODY_MSG_JA} = $File{BODYMSGFILE} . "ja";
$File{BODY_MSG_EN} = $File{BODYMSGFILE} . "en";
$File{DATEINDEX_} = $File{DATEINDEX};
$File{INDEX_} = $File{INDEX};
$File{HEADERFILE_} = $File{HEADERFILE};
$File{FOOTERFILE_} = $File{FOOTERFILE};
$File{PHRASE_}     = $File{PHRASE};
$File{PHRASEINDEX_} = $File{PHRASEINDEX};
$File{REGISTRY_} = $File{REGISTRY};
$File{INDEXINDEX_} = $File{INDEXINDEX};
$File{WORDLIST_} = $File{WORDLIST};
$File{FLIST_} = $File{FLIST};

$File{TMP_WAKATI} = "$DBNAME.wkc";
$File{TMP_I}      = "$DBNAME.tmp_i";
$File{TMP_W}      = "$DBNAME.tmp_w";
$File{TMP_P}      = "$DBNAME.tmp_p";
$File{TMP_PI}     = "$DBNAME.tmp_pi";

$File{CHECKPOINT_}     = "$DBNAME.checkpoint";

## 
## Size of files indexed at once on memory. (bytes)
## If you have much memory, you can increase this value. (128MB or more)
## If you have not much memory, you can decrease this value. (32MB or less)
##
$ON_MEMORY_MAX   = 5000000;
#                  M  K  bytes   

## File size limitation. The file larger than this value will not be indexed.
$FILE_SIZE_LIMIT =  600000;
#                   M  K  bytes   

## Word length limitation. The word longer than this value will be ignored.
$WORD_LENG_MAX   = 128;


##
## Weights for HTML elements
## Element names should be described in CAPITAL letter
##

%Weight = 
    (
     'html' => {
	 'title'  => 16,
	 'h1'     => 8,
	 'h2'     => 7,
	 'h3'     => 6,
	 'h4'     => 5,
	 'h5'     => 4,
	 'h6'     => 3,
	 'a'      => 4,
	 'strong' => 2,
	 'em'     => 2,
	 'kbd'    => 2,
	 'samp'   => 2,
	 'var'    => 2,
	 'code'   => 2,
	 'cite'   => 2,
	 'abbr'   => 2,
	 'acronym'=> 2,
	 'dfn'    => 2,
     },
     'metakey' => 32, # for <META NAME="keywords" CONTENT="foo bar">
     'headers' => 8,  # for mail/news' headers
);

##
## タグを捨てる際に空白を挿入しないタグ
## 例えば、これは<STRONG>重要</STRONG>です。などという文脈ではタグは削除すべき
## だが、 This is foo.<BR>That is bar. という文脈ではタグは空白に変換すべき
##
$NON_SEPARATION_ELEMENTS = 'A|TT|CODE|SAMP|KBD|VAR|B|STRONG|I|EM|CITE|FONT|U|'.
                       'STRIKE|BIG|SMALL|DFN|ABBR|ACRONYM|Q|SUB|SUP|SPAN|BDO';


## タグによる重みづけする際にこの数字以上の長さの文字列の場合は重
## みづけをしない (<H[1-6]> を文字サイズの指定のために本文全体を囲ったり
## している人がいるための処置)
$INVALID_LENG = 128; 



## Length of summary
$SUMMARY_LENGTH = 200;

##
## robots.txt に関する設定
##
$HTDOCUMENT_ROOT = "/usr/local/apache/share/htdocs";
$HTDOCUMENT_ROOT_URI_PREFIX = "http://www.foo.domain.jp/";
$ROBOTS_TXT = "$HTDOCUMENT_ROOT/robots.txt";
$ROBOTS_EXCLUDE_URIS = "";

$INTSIZE = 4;


##
## wakatigaki
##
$USE_NKF_MODULE   = 0;


# options
$NoPhraseIndexOpt = 0;
$DebugOpt         = 0;
$QuietOpt         = 0;
$VerboseOpt       = 0;
$RobotExcludeOpt  = 0;
$NoFieldInfoOpt   = 0;
$NoDateIndexOpt   = 0;
$ManOpt           = 0;
$NoMHonArcOpt     = 0;
$UuencodeOpt      = 0;
$MailNewsOpt      = 0;
$NoLineAdOpt      = 0;
$NoHeadAbstOpt    = 0;
$HiraganaOpt      = 0;
$OkuriganaOpt     = 0;
$NoEdgeSymbolOpt  = 0;
$NoSymbolOpt      = 0;
$NoEncodeURI      = 0;
$NoRegexIndexOpt = 0;
$NoInsertHeaderOpt = 0;
$NoDeleteProcessing = 0;
$NoUpdateProcessing = 0;
$HtaccessExcludeOpt = 0;

%CheckPoint = ("on" => undef, "continue" => undef, "pid" => $$, "fid" => 0);

#

%REQUIRE_ACTIONS = (
		    'text/x-roff' => 'man',
		    'text/plain; x-type=rfc' => 'rfc',
		    'text/html' => 'html',
		    'text/html; x-type=mhonarc' => 'mhonarc',
		    'message/rfc822' => 'mailnews',
		    'message/news' => 'mailnews',
		    'application/pdf' => 'pdf',
		    'application/msword' => 'msword',
		    'application/x-gzip' => 'gzip',
		    'application/x-bzip2' => 'bzip2',
		    'application/x-compress' => 'compress',
);

%RECURSIVE_ACTIONS = (
		      'application/x-gzip' => 1,
		      'application/x-bzip2' => 1,
		      'application/x-compress' => 1,
);

1;
